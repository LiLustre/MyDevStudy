<font size=3>

#### 几个基础概念
- **进程隔离**
    
    出于安全考虑，一个进程不能操作另一个进程的数据，进而一个操作系统必须具备进程隔离这个特性。在Linux系统中，虚拟内存机制为每个进程分配了线性连续的内存空间，操作系统将这种虚拟内存空间映射到物理内存空间，每个进程有自己的虚拟内存空间，进而不能操作其他进程的内存空间，每个进程只能操作自己的虚拟内存空间，只有操作系统才有权限操作物理内存空间。进程隔离保证了每个进程的内存安全，但是在大多数情形下，不同进程间的数据通讯是不可避免的，因此操作系统必须提供跨进程通信机制

- **用户控件和内核空间**
    
    用户空间：表示进程运行在一个特定的操作模式中，没有接触物理内存或设备的权限
    
    内核空间：表示独立于普通的应用程序，可以访问受保护的内存空间，也有访问底层硬件设备的所有权限
- **系统调用/内核态/用户态**

    抽象来看，操作系统中安全边界的概念就像环路的概念一样(前提是系统支持这种特性)，一个环上持有一个特定的权限组，Intel 支持四层环，但是 Linux 只使用了其中的两环(0号环持有全部权限，3号环持有最少权限，1号和2号环未使用)，系统进程运行在1号环，用户进程运行在３号环，如果一个用户进程需要其他高级权限，其必须从３号环过渡成０号环，过渡需要通过一个安全参数检查的网关，这种过渡被称为系统调用，在执行过程中会产生一定数量的计算开销。所以，用户空间要访问内核空间的唯一方式就是系统调用(System Call)
    ![image](https://note.youdao.com/yws/api/personal/file/637D436DECEB4248A08B9AE62F4DF0E0?method=getImage&version=8976&cstk=o_LcPXn1)
- **内核模块/驱动**
    
    通过系统调用，用户空间可以访问内核空间，它是怎么做到访问内核空间的呢？Linux的动态可加载内核模块机制解决了这个问题，模块是具有独立功能的程序，它可以被单独编译，但不能独立运行。这样，Android系统可以通过添加一个内核模块运行在内核空间，用户进程之间的通过这个模块作为桥梁，就可以完成通信了。在Android系统中，这个运行在内核空间的，负责各个用户进程通过Binder通信的内核模块叫做Binder驱动

- **简单的总结**
   
    1、Linux的虚拟内存机制导致内存的隔离，进而导致进程隔离

    2、进程隔离的出现导致对内存的操作被划分为用户空间和内核空间
    
    3、用户空间需要跨权限去访问内核空间，必须使用系统调用去实现
    
    4、系统调用需要借助内核模块/驱动去完成
    
    前三步决定了进程间通讯需要借助内核模块/驱动去实现，而Binder驱动就是内核模块/驱动中用来实现进程间通讯的

#### 为什么要用Binder
    Linux提供有管道、消息队列、信号量、内存共享、套接字等跨进程方式，为什么Android要选择Binder另起炉灶呢？
    
- **传输性能好**
    
    ==Socket==：是一个通用接口，导致其传输效率低，开销大
    
    ==共享内存==：虽然在传输时不需要拷贝数据，但其控制机制复杂，切不安全
    
    ==Binder==：复杂数据类型传递可以复用内存，需要拷贝1次数据
    
    ==管道和消息队列==：采用存储转发方式（采用内存缓冲区的方式，数据先从发送方缓存区拷贝到内核开辟的缓存区中，然后再从内核缓存区拷贝到接收方缓存区，至少有两次拷贝过程），至少需要拷贝2次数据，效率低
- **安全性高**
   
     ==传统的进程==：通信方式对于通信双方的身份并没有做出严格的验证，只有在上层协议上进行架设

    ==Binder机制==：从协议本身就支持对通信双方做身份校检，因而大大提升了安全性

Binder只需要一次拷贝，性能仅次于共享内存，而且采用的传统的C/S结构，稳定性也是没得说，发送添加UID/PID，安全性高

#### Binder本质
面向对象思想的引入将进程间通信转化为通过对某个Binder对象的引用调用该对象的方法，而其独特之处在于Binder对象是一个可以跨进程引用的对象，它的实体位于一个进程中，而它的引用却遍布于系统的各个进程之中。最诱人的是，这个引用和java里引用一样既可以是强类型，也可以是弱类型，而且可以从一个进程传给其它进程，让大家都能访问同一Server，就象将一个对象或引用赋值给另一个引用一样。Binder模糊了进程边界，淡化了进程间通信过程，整个系统仿佛运行于同一个面向对象的程序之中。形形色色的Binder对象以及星罗棋布的引用仿佛粘接各个应用程序的胶水，这也是Binder在英文里的原意